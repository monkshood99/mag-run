'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _column=require('../../../../admin-columns/src/js/table/column');var _column2=_interopRequireDefault(_column);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var ColumnData=function(){/**
	 * @param {Column} column
	 * @param {String} formatted_value
	 * @param {Array} revisions
	 */function ColumnData(column,formatted_value,revisions){_classCallCheck(this,ColumnData);this.column=column;this.current_revision=0;this.revisions=revisions;this.formattedValue=formatted_value}_createClass(ColumnData,[{key:'setFormattedValue',value:function setFormattedValue(value){this.formattedValue=value}},{key:'getFormattedValue',value:function getFormattedValue(){return this.formattedValue}},{key:'setCurrentRevision',value:function setCurrentRevision(index){this.current_revision=index;return this}},{key:'getCurrentRevision',value:function getCurrentRevision(){return this.current_revision}},{key:'setValue',value:function setValue(value){this.value=value}},{key:'getValue',value:function getValue(){return this.revisions[this.getCurrentRevision()]}},{key:'storeRevision',value:function storeRevision(value){var num_deletes=this.revisions.length-this.getCurrentRevision()-1;// Remove any revision that are newer than the current revision
for(var i=0;i<num_deletes;i++){this.revisions.pop()}this.revisions.push(value);this.setCurrentRevision(this.getCurrentRevision()+1);return this}},{key:'save',value:function save(callback){var self=this;$.post(ajaxurl,{action:'acp_editing_column_save',list_screen:AC.list_screen,layout:AC.layout,column:this.column.getName(),pk:this.column.getObjectID(),screen:AC.screen,value:this.getValue(),_ajax_nonce:AC.ajax_nonce},function(response){if(response.success){callback(response)}self.column.getElement(true).trigger('AC_Editing_Saved')},'json')}},{key:'undo',value:function undo(cb_success){if(!this.prev()){return false}cb_success=cb_success?cb_success:function(e){};this.save(function(data){return cb_success(data)})}},{key:'redo',value:function redo(cb_success){if(!this.next()){return false}cb_success=cb_success?cb_success:function(e){};this.save(function(data){return cb_success(data)})}/**
	 * @returns {boolean}
	 */},{key:'prev',value:function prev(){var currentRevision=this.getCurrentRevision();if(currentRevision===0){return false}this.setCurrentRevision(currentRevision-1);return true}/**
	 * @returns {boolean}
	 */},{key:'next',value:function next(){var currentRevision=this.getCurrentRevision();if(currentRevision===this.revisions.length-1){return false}this.setCurrentRevision(currentRevision+1);return true}}]);return ColumnData}();module.exports=ColumnData;